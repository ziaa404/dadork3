
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø·Ù„Ø§Ø¨ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ - Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ø¨Ø´Ø±Ù‰</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            direction: rtl;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1.5" fill="rgba(255,255,255,0.05)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.08)"/><circle cx="10" cy="60" r="1" fill="rgba(255,255,255,0.03)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            opacity: 0.3;
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 15px;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.3);
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .header h2 {
            font-size: 1.5rem;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }

        .auth-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
        }

        .google-signin-btn {
            background: linear-gradient(45deg, #4285f4, #34a853);
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 8px 25px rgba(66, 133, 244, 0.3);
            position: relative;
            overflow: hidden;
        }

        .google-signin-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .google-signin-btn:hover::before {
            left: 100%;
        }

        .google-signin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(66, 133, 244, 0.4);
        }

        .main-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 25px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(10px);
        }

        .teacher-section {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .teacher-input {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .teacher-input label {
            font-weight: bold;
            font-size: 1.3rem;
            color: #333;
            min-width: 120px;
        }

        .teacher-input input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .teacher-input input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.9;
        }

        .student-management {
            margin-bottom: 30px;
        }

        .management-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-add {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
        }

        .btn-add:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(76, 175, 80, 0.4);
        }

        .btn-subject {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-subject:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .btn-export {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
        }

        .btn-export:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
        }

        .search-filter {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            align-items: center;
        }

        .search-input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.2);
        }

        .filter-select {
            padding: 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
        }

        .students-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .student-card {
            background: linear-gradient(135deg, #ffffff, #f8f9fa);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.4s ease;
            position: relative;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .student-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15);
            border-color: rgba(102, 126, 234, 0.3);
        }

        .student-name {
            font-size: 1.4rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .delete-student-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            cursor: pointer;
            font-size: 1.3rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-student-btn:hover {
            background: #ff3742;
            transform: scale(1.1);
        }

        .progress-bars {
            margin: 20px 0;
        }

        .progress-item {
            margin-bottom: 15px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .progress-bar {
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.8s ease;
        }

        .progress-reading {
            background: linear-gradient(90deg, #667eea, #764ba2);
        }

        .progress-writing {
            background: linear-gradient(90deg, #f093fb, #f5576c);
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            margin: 3% auto;
            padding: 40px;
            border-radius: 25px;
            width: 95%;
            max-width: 900px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.3);
            animation: slideInUp 0.4s ease;
        }

        @keyframes slideInUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close {
            color: #aaa;
            float: left;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close:hover {
            color: #000;
            background: #f0f0f0;
        }

        .skill-section {
            margin-bottom: 30px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .skill-title {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .skill-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .skill-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.12);
        }

        .skill-name {
            font-weight: 500;
            color: #333;
            font-size: 1.1rem;
        }

        .skill-buttons {
            display: flex;
            gap: 10px;
        }

        .skill-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 80px;
        }

        .skill-btn.mastered {
            background: #4CAF50;
            color: white;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .skill-btn.not-mastered {
            background: #f44336;
            color: white;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
        }

        .skill-btn:hover {
            transform: scale(1.05);
        }

        .progress-summary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .progress-summary h3 {
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .chart-container {
            margin-top: 30px;
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            z-index: 2000;
            animation: slideInRight 0.3s ease;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .notification.success {
            background: linear-gradient(45deg, #4CAF50, #45a049);
        }

        .notification.info {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .hidden {
            display: none;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #333;
            font-size: 1.1rem;
        }

        .form-group input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.2);
        }

        .share-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-share {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.3);
        }

        .btn-share:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.4);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2rem;
            }
            
            .management-buttons {
                flex-direction: column;
            }
            
            .students-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .modal-content {
                width: 98%;
                margin: 5% auto;
                padding: 25px;
            }

            .search-filter {
                flex-direction: column;
            }

            .stats-overview {
                grid-template-columns: 1fr 1fr;
            }

            .teacher-input {
                flex-direction: column;
                align-items: stretch;
            }

            .teacher-input label {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø·Ù„Ø§Ø¨ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</h1>
            <h2>Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ø¨Ø´Ø±Ù‰ - Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªØ·ÙˆØ±</h2>
        </div>

        <div class="auth-section" id="authSection">
            <h3>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø³Ù†</h3>
            <p>ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</p>
            <button class="google-signin-btn" onclick="simulateGoogleLogin()">
                <span class="loading hidden" id="loginLoading"></span>
                ğŸ“§ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google
            </button>
        </div>

        <div class="main-content hidden" id="mainContent">
            <div class="teacher-section">
                <div class="teacher-input">
                    <label for="teacherName">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…:</label>
                    <input type="text" id="teacherName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…" onchange="saveTeacherName()">
                </div>
            </div>

            <div class="stats-overview" id="statsOverview">
                <div class="stat-card">
                    <div class="stat-number" id="totalStudents">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgReading">0%</div>
                    <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgWriting">0%</div>
                    <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„ÙƒØªØ§Ø¨Ø©</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="excellentStudents">0</div>
                    <div class="stat-label">Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ØªÙÙˆÙ‚ÙˆÙ†</div>
                </div>
            </div>

            <div class="student-management">
                <div class="management-buttons">
                    <button class="btn btn-add" onclick="addStudent()">â• Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨</button>
                    <button class="btn btn-subject" onclick="showLanguageSubject()">ğŸ“š Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
                    <button class="btn btn-export" onclick="exportAllData()">ğŸ“¤ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                </div>

                <div class="search-filter">
                    <input type="text" class="search-input" id="searchInput" placeholder="ğŸ” Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø·Ø§Ù„Ø¨..." onkeyup="filterStudents()">
                    <select class="filter-select" id="progressFilter" onchange="filterStudents()">
                        <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨</option>
                        <option value="excellent">Ø§Ù„Ù…ØªÙÙˆÙ‚ÙˆÙ† (90%+)</option>
                        <option value="good">Ø¬ÙŠØ¯ (70-89%)</option>
                        <option value="needs-improvement">ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ† (<70%)</option>
                    </select>
                </div>
            </div>

            <div class="students-grid" id="studentsGrid">
                <!-- Ø·Ù„Ø§Ø¨ Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ù… Ù‡Ù†Ø§ -->
            </div>

            <div class="chart-container" id="chartContainer" style="display: none;">
                <h3>ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø´Ø§Ù…Ù„ Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø·Ù„Ø§Ø¨</h3>
                <canvas id="progressChart"></canvas>
                <div class="share-buttons">
                    <button class="btn-share" onclick="shareChart()">ğŸ“Š Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ</button>
                    <button class="btn-share" onclick="shareDetailedReport()">ğŸ“‹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙØµÙ„</button>
                    <button class="btn-share" onclick="generatePrintableReport()">ğŸ–¨ï¸ ØªÙ‚Ø±ÙŠØ± Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ -->
    <div id="addStudentModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAddStudentModal()">&times;</span>
            <h2>Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h2>
            <div class="form-group">
                <label for="studentName">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</label>
                <input type="text" id="studentName" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ ÙƒØ§Ù…Ù„Ø§Ù‹">
            </div>
            <div class="form-group">
                <label for="studentId">Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
                <input type="text" id="studentId" placeholder="Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨">
            </div>
            <button class="btn btn-add" onclick="saveStudent()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø·Ø§Ù„Ø¨</button>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© ØªÙ‚ÙŠÙŠÙ… Ù„ØºØªÙŠ -->
    <div id="languageModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLanguageModal()">&times;</span>
            <h2 id="languageModalTitle">ØªÙ‚ÙŠÙŠÙ… Ù…Ø§Ø¯Ø© Ù„ØºØªÙŠ</h2>
            
            <div class="progress-summary" id="progressSummary">
                <h3>ğŸ“ˆ Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ‚Ø¯Ù…</h3>
                <p id="progressText">Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: 0/12 | Ø§Ù„ÙƒØªØ§Ø¨Ø©: 0/12</p>
            </div>

            <div class="skill-section">
                <div class="skill-title">ğŸ“– Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</div>
                <div id="readingSkills">
                    <!-- Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© -->
                </div>
            </div>

            <div class="skill-section">
                <div class="skill-title">âœï¸ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø©</div>
                <div id="writingSkills">
                    <!-- Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø© -->
                </div>
            </div>

            <div class="chart-container">
                <h3>ğŸ“Š Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø·Ø§Ù„Ø¨</h3>
                <canvas id="studentChart"></canvas>
                <div class="share-buttons">
                    <button class="btn-share" onclick="shareStudentProgress()">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„ÙˆÙ„ÙŠ</button>
                    <button class="btn-share" onclick="generateStudentCertificate()">ğŸ† Ø´Ù‡Ø§Ø¯Ø© ØªÙ‚Ø¯ÙŠØ±</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        let students = [];
        let filteredStudents = [];
        let currentStudentId = null;
        let isLoggedIn = false;
        let userEmail = '';
        let charts = {};

        // Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙˆØ§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ø­Ø¯Ø«Ø©
        const readingSkills = [
            'Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ù‡Ø¬Ø§Ø¦ÙŠØ©',
            'Ø§Ù„Ø­Ø±ÙˆÙ Ø¨Ø­Ø±ÙƒØ© Ø§Ù„ÙØªØ­',
            'Ø§Ù„Ø­Ø±ÙˆÙ Ø¨Ø­Ø±ÙƒØ© Ø§Ù„ÙƒØ³Ø±',
            'Ø§Ù„Ø­Ø±ÙˆÙ Ø¨Ø­Ø±ÙƒØ© Ø§Ù„Ø¶Ù…',
            'Ø³Ø±Ø¹Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø­Ø±ÙˆÙ',
            'Ù‚Ø±Ø§Ø¡Ø© ÙƒÙ„Ù…Ø§Øª Ø«Ù„Ø§Ø«ÙŠØ© Ø¨Ø³ÙŠØ·Ø©',
            'Ø§Ù„Ù…Ø¯ Ø¨Ø§Ù„Ø£Ù„Ù ÙˆØ§Ù„ÙˆØ§Ùˆ ÙˆØ§Ù„ÙŠØ§Ø¡',
            'Ø§Ù„Ø³ÙƒÙˆÙ† ÙˆØ¹Ù„Ø§Ù…ØªÙ‡',
            'Ø§Ù„Ù„Ø§Ù… Ø§Ù„Ù‚Ù…Ø±ÙŠØ©',
            'Ø§Ù„Ø´Ø¯Ø©',
            'Ø§Ù„Ù„Ø§Ù… Ø§Ù„Ø´Ù…Ø³ÙŠØ©',
            'Ø§Ù„ØªÙ†ÙˆÙŠÙ†'
        ];

        const writingSkills = [
            'Ø§Ù„ØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙˆÙ',
            'Ø§Ù„Ø­Ø±ÙˆÙ Ø¨Ø­Ø±ÙƒØ© Ø§Ù„ÙØªØ­',
            'Ø§Ù„Ø­Ø±ÙˆÙ Ø¨Ø­Ø±ÙƒØ© Ø§Ù„ÙƒØ³Ø± ÙˆØ§Ù„Ø¶Ù…',
            'Ø³Ø±Ø¹Ø© Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙÙŠ Ø§Ù„Ø­Ø±ÙˆÙ',
            'ÙƒØªØ§Ø¨Ø© ÙƒÙ„Ù…Ø§Øª Ø«Ù„Ø§Ø«ÙŠØ©',
            'Ø§Ù„Ù…Ø¯ Ø¨Ø§Ù„Ø£Ù„Ù ÙˆØ§Ù„ÙˆØ§Ùˆ ÙˆØ§Ù„ÙŠØ§Ø¡',
            'Ø§Ù„Ø³ÙƒÙˆÙ†',
            'Ø§Ù„Ù„Ø§Ù… Ø§Ù„Ù‚Ù…Ø±ÙŠØ©',
            'Ø§Ù„Ø´Ø¯Ø©',
            'Ø§Ù„Ù„Ø§Ù… Ø§Ù„Ø´Ù…Ø³ÙŠØ©',
            'Ø§Ù„ØªÙ†ÙˆÙŠÙ†',
            'Ø§Ù„ØªØ§Ø¡ Ø§Ù„Ù…Ø±Ø¨ÙˆØ·Ø©'
        ];

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
        window.onload = function() {
            loadData();
        };

        // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù€ Google
        function simulateGoogleLogin() {
            // ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ Ù‡Ø°Ø§ Ø³ÙŠÙƒÙˆÙ† ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Google OAuth
            userEmail = 'teacher@albushra.edu.sa';
            isLoggedIn = true;
            
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('mainContent').classList.remove('hidden');
            
            loadData();
            alert('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!');
        }

        // Ø­ÙØ¸ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…
        function saveTeacherName() {
            const teacherName = document.getElementById('teacherName').value;
            localStorage.setItem('teacherName', teacherName);
        }

        // Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯
        function addStudent() {
            document.getElementById('addStudentModal').style.display = 'block';
        }

        function closeAddStudentModal() {
            document.getElementById('addStudentModal').style.display = 'none';
            document.getElementById('studentName').value = '';
        }

        function saveStudent() {
            const name = document.getElementById('studentName').value.trim();
            if (!name) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨');
                return;
            }

            const student = {
                id: Date.now(),
                name: name,
                readingSkills: {},
                writingSkills: {}
            };

            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª
            readingSkills.forEach(skill => {
                student.readingSkills[skill] = false;
            });

            writingSkills.forEach(skill => {
                student.writingSkills[skill] = false;
            });

            students.push(student);
            saveData();
            renderStudents();
            closeAddStudentModal();
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø§Ø¨
        function renderStudents() {
            const grid = document.getElementById('studentsGrid');
            grid.innerHTML = '';

            students.forEach(student => {
                const card = document.createElement('div');
                card.className = 'student-card';
                
                const readingProgress = calculateProgress(student.readingSkills);
                const writingProgress = calculateProgress(student.writingSkills);
                const totalProgress = Math.round((readingProgress + writingProgress) / 2);

                card.innerHTML = `
                    <button class="delete-student-btn" onclick="deleteStudent(${student.id})" title="Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨">Ã—</button>
                    <div class="student-name">${student.name}</div>
                    <div class="progress-summary">
                        <h3>Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¹Ø§Ù…: ${totalProgress}%</h3>
                        <p>Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: ${readingProgress}% | Ø§Ù„ÙƒØªØ§Ø¨Ø©: ${writingProgress}%</p>
                    </div>
                    <button class="btn btn-subject" onclick="openLanguageAssessment(${student.id})">ØªÙ‚ÙŠÙŠÙ… Ù„ØºØªÙŠ</button>
                `;

                grid.appendChild(card);
            });
        }

        // Ø­Ø³Ø§Ø¨ Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
        function calculateProgress(skills) {
            const total = Object.keys(skills).length;
            const mastered = Object.values(skills).filter(skill => skill).length;
            return total > 0 ? Math.round((mastered / total) * 100) : 0;
        }

        // Ø­Ø°Ù Ø·Ø§Ù„Ø¨
        function deleteStudent(studentId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ØŸ')) {
                students = students.filter(student => student.id !== studentId);
                saveData();
                renderStudents();
            }
        }

        // ÙØªØ­ ØªÙ‚ÙŠÙŠÙ… Ù„ØºØªÙŠ
        function openLanguageAssessment(studentId) {
            currentStudentId = studentId;
            const student = students.find(s => s.id === studentId);
            
            document.getElementById('languageModalTitle').textContent = `ØªÙ‚ÙŠÙŠÙ… Ù…Ø§Ø¯Ø© Ù„ØºØªÙŠ - ${student.name}`;
            
            renderSkills();
            updateProgressSummary();
            document.getElementById('languageModal').style.display = 'block';
            
            // Ø±Ø³Ù… Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø·Ø§Ù„Ø¨
            setTimeout(() => renderStudentChart(student), 100);
        }

        function closeLanguageModal() {
            document.getElementById('languageModal').style.display = 'none';
            currentStudentId = null;
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª
        function renderSkills() {
            const student = students.find(s => s.id === currentStudentId);
            
            // Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©
            const readingContainer = document.getElementById('readingSkills');
            readingContainer.innerHTML = '';
            
            readingSkills.forEach(skill => {
                const skillDiv = document.createElement('div');
                skillDiv.className = 'skill-item';
                
                const mastered = student.readingSkills[skill];
                
                skillDiv.innerHTML = `
                    <span class="skill-name">${skill}</span>
                    <div class="skill-buttons">
                        <button class="skill-btn ${mastered ? 'mastered' : ''}" onclick="updateSkill('reading', '${skill}', true)">Ø£ØªÙ‚Ù†</button>
                        <button class="skill-btn ${!mastered ? 'not-mastered' : ''}" onclick="updateSkill('reading', '${skill}', false)">Ù„Ù… ÙŠØªÙ‚Ù†</button>
                    </div>
                `;
                
                readingContainer.appendChild(skillDiv);
            });

            // Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø©
            const writingContainer = document.getElementById('writingSkills');
            writingContainer.innerHTML = '';
            
            writingSkills.forEach(skill => {
                const skillDiv = document.createElement('div');
                skillDiv.className = 'skill-item';
                
                const mastered = student.writingSkills[skill];
                
                skillDiv.innerHTML = `
                    <span class="skill-name">${skill}</span>
                    <div class="skill-buttons">
                        <button class="skill-btn ${mastered ? 'mastered' : ''}" onclick="updateSkill('writing', '${skill}', true)">Ø£ØªÙ‚Ù†</button>
                        <button class="skill-btn ${!mastered ? 'not-mastered' : ''}" onclick="updateSkill('writing', '${skill}', false)">Ù„Ù… ÙŠØªÙ‚Ù†</button>
                    </div>
                `;
                
                writingContainer.appendChild(skillDiv);
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‡Ø§Ø±Ø©
        function updateSkill(type, skill, mastered) {
            const student = students.find(s => s.id === currentStudentId);
            
            if (type === 'reading') {
                student.readingSkills[skill] = mastered;
            } else {
                student.writingSkills[skill] = mastered;
            }
            
            saveData();
            renderSkills();
            updateProgressSummary();
            renderStudents();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
            setTimeout(() => renderStudentChart(student), 100);
        }

        // ØªØ­Ø¯ÙŠØ« Ù…Ù„Ø®Øµ Ø§Ù„ØªÙ‚Ø¯Ù…
        function updateProgressSummary() {
            const student = students.find(s => s.id === currentStudentId);
            const readingProgress = calculateProgress(student.readingSkills);
            const writingProgress = calculateProgress(student.writingSkills);
            
            document.getElementById('progressText').textContent = 
                `Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©: ${readingProgress}% (${Object.values(student.readingSkills).filter(Boolean).length}/${readingSkills.length}) | Ø§Ù„ÙƒØªØ§Ø¨Ø©: ${writingProgress}% (${Object.values(student.writingSkills).filter(Boolean).length}/${writingSkills.length})`;
        }

        // Ø±Ø³Ù… Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø·Ø§Ù„Ø¨
        function renderStudentChart(student) {
            const ctx = document.getElementById('studentChart').getContext('2d');
            
            const readingProgress = calculateProgress(student.readingSkills);
            const writingProgress = calculateProgress(student.writingSkills);
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©', 'Ø§Ù„ÙƒØªØ§Ø¨Ø©'],
                    datasets: [{
                        data: [readingProgress, writingProgress],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(118, 75, 162, 0.8)'
                        ],
                        borderColor: [
                            'rgba(102, 126, 234, 1)',
                            'rgba(118, 75, 162, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                        },
                        title: {
                            display: true,
                            text: `ØªÙ‚Ø¯Ù… Ø§Ù„Ø·Ø§Ù„Ø¨: ${student.name}`
                        }
                    }
                }
            });
        }

        // Ø¹Ø±Ø¶ Ù…ÙˆØ¶ÙˆØ¹ Ù„ØºØªÙŠ
        function showLanguageSubject() {
            if (students.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© Ø·Ù„Ø§Ø¨ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            renderOverallChart();
            document.getElementById('chartContainer').style.display = 'block';
        }

        // Ø±Ø³Ù… Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ø¹Ø§Ù…
        function renderOverallChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            
            const studentNames = students.map(s => s.name);
            const readingData = students.map(s => calculateProgress(s.readingSkills));
            const writingData = students.map(s => calculateProgress(s.writingSkills));
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: studentNames,
                    datasets: [
                        {
                            label: 'Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© (%)',
                            data: readingData,
                            backgroundColor: 'rgba(102, 126, 234, 0.8)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 2
                        },
                        {
                            label: 'Ø§Ù„ÙƒØªØ§Ø¨Ø© (%)',
                            data: writingData,
                            backgroundColor: 'rgba(118, 75, 162, 0.8)',
                            borderColor: 'rgba(118, 75, 162, 1)',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'ØªÙ‚Ø¯Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙÙŠ Ù…Ø§Ø¯Ø© Ù„ØºØªÙŠ'
                        }
                    }
                }
            });
        }

        // Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
        function shareChart() {
            const canvas = document.getElementById('progressChart');
            const imageData = canvas.toDataURL();
            
            // Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù…Ø´Ø§Ø±ÙƒØ©
            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(`
                <!DOCTYPE html>
                <html lang="ar" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <title>ØªÙ‚Ø±ÙŠØ± ØªÙ‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø§Ø¨ - Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ø¨Ø´Ø±Ù‰</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; direction: rtl; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .chart { text-align: center; margin: 20px 0; }
                        .print-btn { background: #667eea; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>ØªÙ‚Ø±ÙŠØ± ØªÙ‚Ø¯Ù… Ø·Ù„Ø§Ø¨ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</h1>
                        <h2>Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ø¨Ø´Ø±Ù‰</h2>
                        <p>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…: ${document.getElementById('teacherName').value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                        <p>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ${new Date().toLocaleDateString('ar-SA')}</p>
                    </div>
                    <div class="chart">
                        <img src="${imageData}" alt="Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø·Ù„Ø§Ø¨" style="max-width: 100%; height: auto;">
                    </div>
                    <button class="print-btn" onclick="window.print()">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                </body>
                </html>
            `);
        }

        // Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙØµÙŠÙ„ÙŠ
        function shareReport() {
            let reportContent = `
                <!DOCTYPE html>
                <html lang="ar" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <title>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙØµÙŠÙ„ÙŠ - Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ø¨Ø´Ø±Ù‰</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; direction: rtl; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .student { margin-bottom: 30px; border: 1px solid #ddd; padding: 20px; border-radius: 10px; }
                        .student-name { font-size: 1.5rem; font-weight: bold; color: #333; margin-bottom: 15px; }
                        .skills-section { margin-bottom: 20px; }
                        .skill-title { font-weight: bold; color: #667eea; margin-bottom: 10px; }
                        .skill-item { padding: 5px 0; }
                        .mastered { color: green; }
                        .not-mastered { color: red; }
                        .progress { background: #f0f0f0; padding: 10px; border-radius: 5px; margin-top: 10px; }
                        .print-btn { background: #667eea; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 20px 0; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙØµÙŠÙ„ÙŠ Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</h1>
                        <h2>Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ø¨Ø´Ø±Ù‰</h2>
                        <p>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…: ${document.getElementById('teacherName').value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                        <p>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ${new Date().toLocaleDateString('ar-SA')}</p>
                        <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨: ${students.length}</p>
                    </div>
                    <button class="print-btn" onclick="window.print()">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
            `;

            students.forEach(student => {
                const readingProgress = calculateProgress(student.readingSkills);
                const writingProgress = calculateProgress(student.writingSkills);
                
                reportContent += `
                    <div class="student">
                        <div class="student-name">${student.name}</div>
                        <div class="progress">
                            <strong>Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¹Ø§Ù…:</strong> Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ${readingProgress}% | Ø§Ù„ÙƒØªØ§Ø¨Ø© ${writingProgress}%
                        </div>
                        
                        <div class="skills-section">
                            <div class="skill-title">ğŸ“– Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©:</div>
                `;
                
                readingSkills.forEach(skill => {
                    const mastered = student.readingSkills[skill];
                    reportContent += `
                        <div class="skill-item ${mastered ? 'mastered' : 'not-mastered'}">
                            ${skill}: ${mastered ? 'âœ“ Ø£ØªÙ‚Ù†' : 'âœ— Ù„Ù… ÙŠØªÙ‚Ù†'}
                        </div>
                    `;
                });
                
                reportContent += `
                        </div>
                        <div class="skills-section">
                            <div class="skill-title">âœï¸ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø©:</div>
                `;
                
                writingSkills.forEach(skill => {
                    const mastered = student.writingSkills[skill];
                    reportContent += `
                        <div class="skill-item ${mastered ? 'mastered' : 'not-mastered'}">
                            ${skill}: ${mastered ? 'âœ“ Ø£ØªÙ‚Ù†' : 'âœ— Ù„Ù… ÙŠØªÙ‚Ù†'}
                        </div>
                    `;
                });
                
                reportContent += `
                        </div>
                    </div>
                `;
            });

            reportContent += `
                </body>
                </html>
            `;

            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(reportContent);
        }

        // Ù…Ø´Ø§Ø±ÙƒØ© ØªÙ‚Ø¯Ù… Ø·Ø§Ù„Ø¨ ÙˆØ§Ø­Ø¯
        function shareStudentProgress() {
            const student = students.find(s => s.id === currentStudentId);
            const canvas = document.getElementById('studentChart');
            const imageData = canvas.toDataURL();
            
            const readingProgress = calculateProgress(student.readingSkills);
            const writingProgress = calculateProgress(student.writingSkills);
            
            let reportContent = `
                <!DOCTYPE html>
                <html lang="ar" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <title>ØªÙ‚Ø±ÙŠØ± ØªÙ‚Ø¯Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ - ${student.name}</title>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; direction: rtl; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .student-info { background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
                        .chart { text-align: center; margin: 20px 0; }
                        .skills-section { margin-bottom: 20px; }
                        .skill-title { font-weight: bold; color: #667eea; margin-bottom: 10px; }
                        .skill-item { padding: 5px 0; }
                        .mastered { color: green; }
                        .not-mastered { color: red; }
                        .print-btn { background: #667eea; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>ØªÙ‚Ø±ÙŠØ± ØªÙ‚Ø¯Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</h1>
                        <h2>Ù…Ø¯Ø§Ø±Ø³ Ø§Ù„Ø¨Ø´Ø±Ù‰ - Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ</h2>
                    </div>
                    
                    <div class="student-info">
                        <h2>Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨: ${student.name}</h2>
                        <p>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…: ${document.getElementById('teacherName').value || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                        <p>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±: ${new Date().toLocaleDateString('ar-SA')}</p>
                        <p><strong>Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¹Ø§Ù…:</strong> Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ${readingProgress}% | Ø§Ù„ÙƒØªØ§Ø¨Ø© ${writingProgress}%</p>
                    </div>
                    
                    <div class="chart">
                        <img src="${imageData}" alt="Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø·Ø§Ù„Ø¨" style="max-width: 400px; height: auto;">
                    </div>
                    
                    <div class="skills-section">
                        <div class="skill-title">ğŸ“– Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©:</div>
            `;
            
            readingSkills.forEach(skill => {
                const mastered = student.readingSkills[skill];
                reportContent += `
                    <div class="skill-item ${mastered ? 'mastered' : 'not-mastered'}">
                        ${skill}: ${mastered ? 'âœ“ Ø£ØªÙ‚Ù†' : 'âœ— Ù„Ù… ÙŠØªÙ‚Ù†'}
                    </div>
                `;
            });
            
            reportContent += `
                    </div>
                    <div class="skills-section">
                        <div class="skill-title">âœï¸ Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„ÙƒØªØ§Ø¨Ø©:</div>
            `;
            
            writingSkills.forEach(skill => {
                const mastered = student.writingSkills[skill];
                reportContent += `
                    <div class="skill-item ${mastered ? 'mastered' : 'not-mastered'}">
                        ${skill}: ${mastered ? 'âœ“ Ø£ØªÙ‚Ù†' : 'âœ— Ù„Ù… ÙŠØªÙ‚Ù†'}
                    </div>
                `;
            });
            
            reportContent += `
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button class="print-btn" onclick="window.print()">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
                        <p style="margin-top: 20px; color: #666;">
                            Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙŠÙ…ÙƒÙ† Ø·Ø¨Ø§Ø¹ØªÙ‡ Ø£Ùˆ Ø­ÙØ¸Ù‡ ÙƒÙ€ PDF Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡ Ù„ÙˆÙ„ÙŠ Ø§Ù„Ø£Ù…Ø±
                        </p>
                    </div>
                </body>
                </html>
            `;

            const reportWindow = window.open('', '_blank');
            reportWindow.document.write(reportContent);
        }

        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function saveData() {
            if (isLoggedIn) {
                const data = {
                    students: students,
                    teacherName: document.getElementById('teacherName').value,
                    lastSaved: new Date().toISOString(),
                    userEmail: userEmail
                };
                
                // Ø­ÙØ¸ ÙÙŠ localStorage (Ù…Ø­Ø§ÙƒØ§Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)
                localStorage.setItem('studentTrackingData', JSON.stringify(data));
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ
                showSaveNotification();
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function loadData() {
            const savedData = localStorage.getItem('studentTrackingData');
            if (savedData) {
                const data = JSON.parse(savedData);
                students = data.students || [];
                
                if (data.teacherName) {
                    document.getElementById('teacherName').value = data.teacherName;
                }
                
                renderStudents();
            }
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø­ÙØ¸ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function showSaveNotification() {
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø­ÙØ¸
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #4CAF50;
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                z-index: 1001;
                font-weight: bold;
                animation: slideInRight 0.3s ease;
            `;
            notification.textContent = 'âœ“ ØªÙ… Ø§Ù„Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹';
            
            document.body.appendChild(notification);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø¹Ø¯ 3 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Ø¥Ø¶Ø§ÙØ© CSS Ù„Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
        setInterval(() => {
            if (isLoggedIn && students.length > 0) {
                saveData();
            }
        }, 30000);

        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', function() {
            if (isLoggedIn) {
                saveData();
            }
        });

        // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ù„Ø¹Ø±Ø¶
        function addSampleData() {
            if (students.length === 0) {
                const sampleStudents = [
                    { name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', id: 1001 },
                    { name: 'ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ', id: 1002 },
                    { name: 'Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡', id: 1003 }
                ];

                sampleStudents.forEach(sampleStudent => {
                    const student = {
                        id: sampleStudent.id,
                        name: sampleStudent.name,
                        readingSkills: {},
                        writingSkills: {}
                    };

                    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª
                    readingSkills.forEach(skill => {
                        student.readingSkills[skill] = Math.random() > 0.5;
                    });

                    writingSkills.forEach(skill => {
                        student.writingSkills[skill] = Math.random() > 0.5;
                    });

                    students.push(student);
                });

                saveData();
                renderStudents();
            }
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¹Ù†Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø£ÙˆÙ„ Ù…Ø±Ø©
        setTimeout(() => {
            if (isLoggedIn && students.length === 0) {
                addSampleData();
            }
        }, 1000);

    </script>
</body>
</html>
